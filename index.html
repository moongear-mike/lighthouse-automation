<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lighthouse testing for really awesome results - MoonGear.com</title>
    <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAD/0lEQVR4Xu2aj7EMQRCHfy8CRIAIEAEiQASIABEgAkSACBABIkAEiAARUF+Zrpraur2Z7pnZd7e3U3X1ql7tznR/8+vu+bNnOvF2duL+awOwKeDECWwhcOIC2JLgFgJbCCxD4KakW+l3UdL1ybBfJf2W9Cn9Pi9jlobmAJx8JOmuJJz2NGC8l/RKEnCGtRE5AMdfpNk2w3+mmcUpnONnjvE8gPgBC6VczjxGFU9GgegNAMcfZ8Yzg28CxgPlQVKQdfdS0vMEr5siegG4IuldFttvJT2T9KPRUvqln/upH1TzMAB01oweAJitj0nCSB0Z945bxiB8CA3C53avMVoB5M5/S/GLgSMaOYJ8cK0nhBYAyPNLmnkkT8wu0cgphEQXJbQAwHkUwMxP6/poEIQYSuAv4RBWXRQAiempJGIe58MGBEkRDjhPTqDS5JXH1WUEAA4z+7QbvZKRy+r/D3exIwKAjM9iZcm4n+Nj+YDkSCi4mxcAie97GuXqTJ3/O2NF7Vie93N7QmqsNcp8MuL74s7jwC5W3vdZIbLnCCnSC+BXKnv7aJsD3r7n5Fvqz3IBifiSNwY8RhL3xD+ZH+lFDfbaWAJAfyy5qQjkAfJBdfMAsNJXklqNwRjY8zkLTTZL2FndPABYi9+RdC+ty1sV0BMA+w82Yx/SXmQIAFv5uWU2Y00tgBpnLDxZHJGfqptHAWZwqNzssKgngHxR5PHJdSTWavBceZuycTmQvRyyzzNYaIAdBpbk6bEp7ytkn2ewYwgB987UA8C2oIecBDlOJyFWNw+AYyiDQwEcw0KI43P2BtXNowCrtSw72Qm2LoRqjaxJbuxQWZ67S7QHAAaz4bhQGKjG4Frnea7Un60BSnuUnWN6AdjW8xC3w6GjMS+AQz4QmTug2as2LwA6s2pQ2hV6ZB591naBYVsiAJqPoaLeTt7L1/+h2ae/CADes5JIRSDznsexOJmf43H3GUAOMgqAPvLLCdcWtIMCbGvuXvhMx24BQCgAgbJILHJru0R7na7h/qTa36S+FgA4SxxyBgeE5muqAj3kzpmkXcN1Ga8VwBQCOYEjsxHX4xx5oTpmnnHO9W5wOlkYRnnEKBohQXLq8YEEd5B280zMc/5Hs6vyJiX0UEAOw6qD/Y+VIzXaqwhkzhV4fuk5zfb59wJhCL0B4Pj0sxb+hxKYMftIChnnH0mRQ/KPpPJ7h32f2zRDGAHAZh8nmEHki4OexsYGWCioFEZNEEYCyB1G0sSufRLHh5PW7KNI+1ASx0tOT2GGISwFwDP70WdDENYEAHBuCGsD4IawRgAuCGsFMIUwu2NcMwCDQCmevTJfO4BiRdkAFBGt/IFNASuf4KJ7J6+Af1+CBFDSbROOAAAAAElFTkSuQmCC"
          rel="icon" type="image/x-icon"/>
    <style>

        html, body {
            padding: 0;
            margin: 0;
            color: #000;
            font-family: Arial, Helvetica, sans-serif;
        }

        #lh_form {
            background-color: #ededed;
            padding: 5px 5px 20px 5px;
            border-bottom: 1px #000 solid;
            font-size: 12px;
        }

        label {
            display: inline-block;
        }

        #lh_api_key {
            width: 90%;
        }

        .lh_section {
            padding: 10px;
            display: inline-block;
            min-height: 60px;
            min-width: 300px;
            border: 1px solid #bfbfbf;
            margin: 2px;
            max-width: 300px;
            float: left;
        }

        .lh_section:nth-child(odd) {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .lh_option_title {
            font-weight: 600;
        }

        #lh_submit_wrapper {
            text-align: center;
        }

        #lh_submit_wrapper input {
            background-color: #fff0ae;
            padding: 5px;
            border: 1px solid #000;
            font-size: 16px;
            line-height: 30px;
            font-weight: 800;
        }

        #lh_iframe, #lh_iframe body, #lh_iframe html {
            width: 100%;
            margin: 0;
            padding: 0;
            border: 0;
        }


        /* Absolute Center Spinner */
        .loading {
            position: fixed;
            z-index: 999;
            height: 2em;
            width: 2em;
            overflow: visible;
            margin: auto;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }

        /* Transparent Overlay */
        .loading:before {
            content: '';
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
        }

        .loading.hidden:before {
            display: none;
        }

        /* :not(:required) hides these rules from IE9 and below */
        .loading:not(:required) {
            /* hide "loading..." text */
            font: 0/0 a;
            color: transparent;
            text-shadow: none;
            background-color: transparent;
            border: 0;
        }

        .loading:not(:required):after {
            content: '';
            display: block;
            font-size: 10px;
            width: 1em;
            height: 1em;
            margin-top: -0.5em;
            -webkit-animation: spinner 1500ms infinite linear;
            -moz-animation: spinner 1500ms infinite linear;
            -ms-animation: spinner 1500ms infinite linear;
            -o-animation: spinner 1500ms infinite linear;
            animation: spinner 1500ms infinite linear;
            border-radius: 0.5em;
            -webkit-box-shadow: rgba(0, 0, 0, 0.75) 1.5em 0 0 0, rgba(0, 0, 0, 0.75) 1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) 0 1.5em 0 0, rgba(0, 0, 0, 0.75) -1.1em 1.1em 0 0, rgba(0, 0, 0, 0.5) -1.5em 0 0 0, rgba(0, 0, 0, 0.5) -1.1em -1.1em 0 0, rgba(0, 0, 0, 0.75) 0 -1.5em 0 0, rgba(0, 0, 0, 0.75) 1.1em -1.1em 0 0;
            box-shadow: rgba(0, 0, 0, 0.75) 1.5em 0 0 0, rgba(0, 0, 0, 0.75) 1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) 0 1.5em 0 0, rgba(0, 0, 0, 0.75) -1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) -1.5em 0 0 0, rgba(0, 0, 0, 0.75) -1.1em -1.1em 0 0, rgba(0, 0, 0, 0.75) 0 -1.5em 0 0, rgba(0, 0, 0, 0.75) 1.1em -1.1em 0 0;
        }

        .loading.hidden:not(:required):after {
            display: none;
        }

        .more-info {
            z-index: 100000;
            color: #000;
            width: 100%;
            text-align: center;
            height: 100%;
            position: fixed;
            font-size: 18px;
            font-weight: 600;
            display: none;
            margin: 5px;
        }

        }

        /* Animation */

        @-webkit-keyframes spinner {
            0% {
                -webkit-transform: rotate(0deg);
                -moz-transform: rotate(0deg);
                -ms-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                -moz-transform: rotate(360deg);
                -ms-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @-moz-keyframes spinner {
            0% {
                -webkit-transform: rotate(0deg);
                -moz-transform: rotate(0deg);
                -ms-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                -moz-transform: rotate(360deg);
                -ms-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @-o-keyframes spinner {
            0% {
                -webkit-transform: rotate(0deg);
                -moz-transform: rotate(0deg);
                -ms-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                -moz-transform: rotate(360deg);
                -ms-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @keyframes spinner {
            0% {
                -webkit-transform: rotate(0deg);
                -moz-transform: rotate(0deg);
                -ms-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                -moz-transform: rotate(360deg);
                -ms-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }


    </style>
    <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <script>

        var chromeisbusy;
        var $lh = jQuery.noConflict();
        var refreshcount = 0;
        var readyalert = window.setTimeout(function () {
            $lh('.more-info div').html('');
        }, 1000);

        var failsafe = window.setTimeout(function () {
            $lh('.more-info span').html('?');
            $lh('.more-info div').html('Server is taking too long.');
            $lh('.loading').addClass('hidden');
            refreshcount = 0;
        }, 10000);

        $lh('.loading').removeClass('hidden');

        $lh(window, 'iframe').resize(function () {
            fixiframe()
        });

        function iframe_loaded() {

            var chromeisbusy = jQuery("#lh_iframe").contents().find('#server-busy').data('status');

            if (chromeisbusy > 20) {
                $lh('.more-info span').html('?');
                $lh('.more-info div').html('Server is taking too long.');
                $lh('.loading').addClass('hidden');
                refreshcount = 0;
                clearTimeout(readyalert);
                clearTimeout(failsafe);
            }
            else if (chromeisbusy > 0) {
                // Do something for busy
                $lh('.more-info').show();

                retryrun = setTimeout(function () {
                    $lh('#lh_form form').submit();
                    clearTimeout(failsafe);
                    clearTimeout(readyalert);
                    readyalert = window.setTimeout(function () {
                        $lh('.more-info span').html('0');
                        $lh('.more-info div').html('Almost done! Getting your results now...');
                    }, 2000);
                    refreshcount++;
                    // console.log(refreshcount);
                    $lh('.more-info span').html(chromeisbusy);
                    $lh('.more-info div').append('. ');
                }, 200);
            } else {
                clearTimeout(failsafe);
                $lh('.more-info').hide();
                $lh('.more-info span').html('0');
                $lh('.more-info div').html('');
                $lh('.loading').addClass('hidden');
                refreshcount = 0;
            }

            $lh('html *', $lh('iframe').contents()).on('click', (function () {
                fixiframe()
            }));

            fixiframe();
        }

        function fixiframe() {
            setTimeout(function () {
                $lh('iframe').attr('height', $lh('html', $lh('iframe').contents()).height());
                // console.log($lh('html', $lh('iframe').contents()).height());
            }, 200);
        }

        $lh(document).ready(function () {
            $lh('.loading').addClass('hidden');

            $lh('#lh_website').blur(function () {
                fix_protocol();
            });

            $lh('#lh_form form').submit(function (e) {

                $lh("#lh_iframe").attr('src', 'about:blank');

                fix_protocol();

                var lh_schema = $lh('#lh_schema').val();
                var lh_website = $lh('#lh_website').val();
                var lh_form_factor = $lh("input[name='lh_form_factor']:checked").val();

                // var lh_iframe = $lh("#lh_iframe").contents();

                var lh_domain = location.protocol + "//" + location.host;

                var d = new Date();
                var n = d.getTime();

                $lh(this).attr('action', '/' + n + '/');

                var lh_iframe_src = lh_domain + '/' + n + '/?lh_schema=' + lh_schema + '&lh_website=' + lh_website + '&lh_form_factor=' + lh_form_factor + '&lh_time=' + n;

                // console.log(lh_iframe_src);

                $lh('.loading').removeClass('hidden');

                // $lh("#lh_iframe").attr('src', lh_iframe_src);

                return true;

            });

            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }

            jQuery('#lh_api_key').val(vars['lh_api_key']);

            function fix_protocol() {
                var website_protocol = /((^\w+:|^)\/\/)/.exec($lh('#lh_website').val());

                try {
                    if ((website_protocol[1] === 'http://' || website_protocol[1] === 'https://')) {
                        $lh('#lh_schema').val(website_protocol[1]);
                    }
                } catch (e) {
                    // I don't care
                }

                $lh('#lh_website').val($lh('#lh_website').val().replace(/(^\w+:|^)\/\//, ''));
            }

        });


    </script>

</head>
<body>
<div class="loading"></div>
<div id="lh_form">
    <form method="post" action="/" target="lh_iframe" onsubmit="">

        <div class="lh_section">
            <div class="lh_option_title">Website URL:</div>
            <label for="lh_schema"></label>

            <select id="lh_schema" name="lh_schema">
                <option value="https://">https://</option>
                <option value="http://">http://</option>
            </select>

            <label for="lh_website"></label><input id="lh_website" type="text" name="lh_website"
                                                   placeholder="www.example.com" value="www.moongear.com">
        </div>
        <div class="lh_section">
            <div class="lh_option_title">Form Factor:</div>
            <label for="lh_form_factor_mobile">
                <input id="lh_form_factor_mobile" name="lh_form_factor" type="radio" checked value="mobile"> Mobile
            </label>
            <label for="lh_form_factor_desktop">
                <input id="lh_form_factor_desktop" name="lh_form_factor" type="radio" value="desktop">
                Desktop </label>
        </div>

        <div class="lh_section">
            <div class="lh_categories">Categories:</div>
            <label for="lh_categories_performance">
                <input id="lh_categories_performance" name="lh_categories[]" type="checkbox" checked
                       value="performance"> Performance
            </label>
            <label for="lh_categories_accessibility">
                <input id="lh_categories_accessibility" name="lh_categories[]" type="checkbox" checked
                       value="accessibility"> Accessibility
            </label>
            <label for="lh_categories_best-practices">
                <input id="lh_categories_best-practices" name="lh_categories[]" type="checkbox" checked
                       value="best-practices"> Best-Practices
            </label>
            <label for="lh_categories_seo">
                <input id="lh_categories_seo" name="lh_categories[]" type="checkbox" checked value="seo"> SEO
            </label>
            <label for="lh_categories_pwa">
                <input id="lh_categories_pwa" name="lh_categories[]" type="checkbox" value="pwa"> PWA
            </label>
        </div>


        <div class="lh_section">
            <div class="lh_throttle_method">Throttle Method:</div>
            <label for="lh_throttle_method_simulate">
                <input id="lh_throttle_method_simulate" name="lh_throttle_method" type="radio" checked value="simulate">
                Simulate </label>
            <label for="lh_throttle_method_devtools">
                <input id="lh_throttle_method_devtools" name="lh_throttle_method" type="radio" value="devtools">
                Devtools
            </label>
            <label for="lh_throttle_method_provided">
                <input id="lh_throttle_method_provided" name="lh_throttle_method" type="radio" value="provided">
                Provided </label>
        </div>
        <div class="lh_section">
            <div class="lh_option_title">API Key:</div>
            <label for="lh_api_key"></label><input id="lh_api_key" type="text" name="lh_api_key"
                                                   placeholder="API KEY REQUIRED" value="">
        </div>

        <div id="lh_submit_wrapper" style="clear: both">
            <div><input type="submit" value="Run Lighthouse Test"></div>
        </div>
    </form>
</div>
<div class="more-info">Server is busy working on <span>?</span> other processes.
    <div></div>
</div>

<div class="iframe-container">
    <iframe id="lh_iframe" name="lh_iframe" scrolling="no" src="" height="" allowfullscreen></iframe>
</div>


</body>
</html>